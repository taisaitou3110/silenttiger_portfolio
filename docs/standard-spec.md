# Development Standard Specifications / é–‹ç™ºæ¨™æº–ä»•æ§˜æ›¸

## 1. Core Library Specifications / ä¸»è¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä»•æ§˜

* **Jimp**:
  * Version: ^1.6.0 (Strictly follow v1.x API)
  * Rule (JP): å¿…ãš `import { Jimp } from 'jimp'` ã‚’ä½¿ç”¨ã—ã€ç ´å£Šçš„å¤‰æ›´ï¼ˆqualityãƒ¡ã‚½ãƒƒãƒ‰ã®å»ƒæ­¢ç­‰ï¼‰ã‚’åæ˜ ã™ã‚‹ã“ã¨ã€‚
  * Rule (EN): Always use `import { Jimp } from 'jimp'`. Follow v1.x breaking changes (e.g., image.quality is deprecated).

* **Next.js**:
  * Version: 15.x (App Router / React 19)
  * Rule (JP): **React 19ã®æœ€æ–°ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã€‚**
    * `useFormState` ã¯å»ƒæ­¢ã€‚å¿…ãš `import { useActionState } from 'react'` ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã€‚
    * `useFormStatus` ã‚‚å¿…è¦ã«å¿œã˜ã¦ `react` ã‹ã‚‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ã€‚
  * Rule (EN): Use the latest React 19 hooks. Replace `useFormState` with `useActionState` imported from 'react'.

## 2. Shared Components / å…±é€šéƒ¨å“

* **Image Processing**:
  * Function: `processImage(base64EncodedImage, mimeType)`
  * Rule (JP): ç”»åƒå‡¦ç†ã«ã¯å¿…ãšã“ã®å…±é€šé–¢æ•°ã‚’é€šã™ã“ã¨ã€‚
  * Rule (EN): All image processing must pass through this shared function.

## 3. Layout & Navigation / ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒ»ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³æ¨™æº–

### 3.1 Basic Structure (åŸºæœ¬æ§‹é€ )
* **Desktop (PC/Tablet)**:
  * **Sidebar (Left)**: ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒªã‚¹ãƒˆã€‚å¹… 240pxã€œ280pxã€‚ã‚¢ãƒ—ãƒªé–“ç§»å‹•ç”¨ã€‚
  * **Main Content (Right)**: æ©Ÿèƒ½ç”»é¢ã€‚èƒŒæ™¯ã¯ `slate-50` ç­‰ã®æ·¡ã„è‰²ã‚’æ¨å¥¨ã€‚
* **Mobile (< 640px)**:
  * **Single Column**: ã‚µã‚¤ãƒ‰ãƒãƒ¼ã¯éè¡¨ç¤ºã«ã—ã€ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¾ãŸã¯ãƒœãƒˆãƒ ãƒ‰ãƒ­ãƒ¯ãƒ¼ï¼ˆ`AIAssistantDrawer` é€£æºï¼‰ã«é›†ç´„ã™ã‚‹ã€‚

### 3.2 Responsive Sizing (ã‚µã‚¤ã‚ºåˆ¶å¾¡)
* **Button Size**:
  * **Mobile (Portrait)**: é«˜ã•æœ€ä½ 44pxã€å¹…ã¯ `w-full` ã‚’åŸºæœ¬ã¨ã™ã‚‹ã€‚
  * **Mobile (Landscape) / Tablet**: é«˜ã•ã‚’ã‚„ã‚„æŠ‘ãˆï¼ˆ`py-3`ï¼‰ã€è¦ç´ ã‚’æ¨ªã«ä¸¦ã¹ã‚‹ã€‚
  * **PC**: ãƒã‚¦ã‚¹æ“ä½œç”¨ã«æœ€é©åŒ–ã—ãŸã‚³ãƒ³ãƒ‘ã‚¯ãƒˆãªã‚µã‚¤ã‚ºï¼ˆ`py-2 px-6`ï¼‰ã€‚
* **Safe Area**: ãƒ¢ãƒã‚¤ãƒ«ç«¯æœ«ã®ãƒãƒƒãƒã‚„ãƒ›ãƒ¼ãƒ ãƒãƒ¼ã‚’è€ƒæ…®ã—ã€æœ€ä¸‹éƒ¨è¦ç´ ã«ã¯ `pb-safe` ã¾ãŸã¯ååˆ†ãªä½™ç™½ã‚’è¨­å®šã™ã‚‹ã“ã¨ã€‚

## 4. Responsive & Common Message Box / ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ»å…±é€šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä»•æ§˜

### 4.1 FFMessageBox (RPG Style Message)
* **Placement**: ç”»é¢ä¸‹éƒ¨ã«å›ºå®šé…ç½®ã€‚
* **Rule (JP)**: ã‚²ãƒ¼ãƒ çš„ãªæ¼”å‡ºã‚„é‡è¦ãªé€šçŸ¥ã€AIã®èãè¿”ã—ã«ã¯å¿…ãš `FFMessageBox` ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã€‚
* **Visual**: é’è‰²ã®ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³èƒŒæ™¯ã€ç™½ã®äºŒé‡æ ç·šã‚’ç¶­æŒã€‚ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä»˜ä¸ã™ã‚‹ã“ã¨ã€‚

### 4.2 Common Message Box Component
* **Unified Interface**: `MessageBox` ã¾ãŸã¯ `useMessage` ã‚’ä½¿ç”¨ã—ã€`window.alert` ç­‰ã®ãƒã‚¤ãƒ†ã‚£ãƒ–æ©Ÿèƒ½ã¯ä½¿ç”¨ç¦æ­¢ã€‚
* **Status Types**: 'success' | 'error' | 'warning' | 'info'
### 4.3 Message Master (Mandatory):
* Path: @/components/MessageMst.ts
* Rule (JP): ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã€ç›´æ¥ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«æ›¸ãè¾¼ã¾ãšã€å¿…ãš MESSAGE_MASTER ã‹ã‚‰å–å¾—ã™ã‚‹ã“ã¨ã€‚
* Rule (EN): Error Messages displayed to the user must be retrieved from MESSAGE_MASTER, not written directly into the source code.

## 5. Error Capturing & User Feedback / ã‚¨ãƒ©ãƒ¼ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ¼ã¨ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

### 1. åŸºæœ¬æ€æƒ³ï¼šã‚¨ãƒ©ãƒ¼ã®ã€Œç¿»è¨³ã€
ã‚·ã‚¹ãƒ†ãƒ ãŒç™ºç”Ÿã•ã›ã‚‹ã€Œç”Ÿã®ã‚¨ãƒ©ãƒ¼ï¼ˆã‚¤ãƒ³ãƒ•ãƒ©ã‚¨ãƒ©ãƒ¼ã€APIã‚¨ãƒ©ãƒ¼ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ï¼‰ã€ã‚’ãã®ã¾ã¾è¡¨ç¤ºã›ãšã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ¬¡ã«å–ã‚‹ã¹ãè¡Œå‹•ï¼ˆè§£æ±ºç­–ï¼‰ã‚’æç¤ºã™ã‚‹ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªãƒŠãƒ¬ãƒƒã‚¸ã€ã¸ã¨ç¿»è¨³ã™ã‚‹ã€‚

### 2. æŠ€è¡“çš„åˆ¶ç´„ï¼ˆæ—§5.1ç¯€ ç¶™æ‰¿ï¼‰
* **Vercel Digestã®éš è”½**: Vercelç’°å¢ƒã§å†…éƒ¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸéš›ã«ç™ºè¡Œã•ã‚Œã‚‹ `digest` IDã‚„ã€æš—å·åŒ–ã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç›´æ¥ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¦‹ã›ã¦ã¯ãªã‚‰ãªã„ã€‚
* **AppErrorã¸ã®é›†ç´„**: å…¨ã¦ã®ã‚¨ãƒ©ãƒ¼ã¯ `lib/error.ts` ã§å®šç¾©ã•ã‚ŒãŸ `AppError` ã‚¯ãƒ©ã‚¹ã‚’çµŒç”±ã—ã€ä¸€æ„ã® `ErrorCode`ï¼ˆåˆè¨€è‘‰ï¼‰ã«å¤‰æ›ã—ã¦ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¸ä¼ãˆã‚‹ã€‚

### 3. ä¸‰å±¤ã®ç®¡ç†æ§‹é€ 
æƒ…å ±ã¯ä»¥ä¸‹ã®3ãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ†é›¢ã—ã€å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã¸ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç›´æ›¸ãï¼ˆãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ï¼‰ã‚’å³ç¦ã¨ã™ã‚‹ã€‚

| ãƒ•ã‚¡ã‚¤ãƒ« | å½¹å‰² | è¨˜è¿°å†…å®¹ã®ä¾‹ |
| :--- | :--- | :--- |
| `constants/config.ts` | **å®šæ•°ç®¡ç†** | `MAX_FILE_SIZE_BYTES`, `BYTES_PER_MB` ç­‰ã®æ•°å€¤è¨­å®š |
| `constants/errorMessages.ts` | **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¾æ›¸** | `title`, `description` (å…·ä½“çš„ãªè§£æ±ºç­–), `actionText` |
| `lib/error.ts` | **ãƒ­ã‚¸ãƒƒã‚¯ç®¡ç†** | `AppError` ã‚¯ãƒ©ã‚¹ã®å®šç¾©ãŠã‚ˆã³ã‚¨ãƒ©ãƒ¼å¤‰æ›ãƒ»åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ |

### 4. å…·ä½“çš„ãªã‚¨ãƒ©ãƒ¼ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ¼å¯¾è±¡ã¨å¯¾å¿œï¼ˆæ—§5.2ç¯€ çµ±åˆï¼‰
VercelãŠã‚ˆã³AI APIã®åˆ¶é™ãƒ»ç‰¹æ€§ã«åˆã‚ã›ã€ä»¥ä¸‹ã®ErrorCodeã‚’é©åˆ‡ã«æŠ•ã’åˆ†ã‘ã‚‹ã€‚

| å¯¾è±¡ | ç™ºç”ŸåŸå›  | å¯¾å¿œErrorCode | descriptionï¼ˆãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æŒ‡é‡ï¼‰ |
| :--- | :--- | :--- | :--- |
| **1. Timeout** | Vercelã®å®Ÿè¡Œæ™‚é–“åˆ¶é™ | `INFRA_TIMEOUT` | é€šä¿¡ç’°å¢ƒã®ç¢ºèªã¨å†è©¦è¡Œã‚’å…·ä½“çš„ã«ä¿ƒã™ã€‚ |
| **2. Quota** | APIç„¡æ–™æ ã®è¶…é | `AI_RATE_LIMIT` | ã€Œ1åˆ†ç¨‹åº¦ã®å¾…æ©ŸãŒå¿…è¦ã€ãªæ—¨ã‚’æ˜è¨˜ã™ã‚‹ã€‚ |
| **3. Payload** | é€ä¿¡ã‚µã‚¤ã‚ºè¶…é | `VALIDATION_IMAGE_SIZE` | ã€Œ3MBä»¥ä¸‹ã€ã¨ã„ã†å…·ä½“çš„ãªåˆ¶é™å€¤ã‚’æç¤ºã™ã‚‹ã€‚ |
| **4. Safety** | AIã«ã‚ˆã‚‹å›ç­”æ‹’å¦ | `AI_SAFETY_REJECT` | é£Ÿã¹ç‰©ã®å†™çœŸã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã‚ˆã†èª˜å°ã™ã‚‹ã€‚ |
| **5. Response** | AIã®å‡ºåŠ›å½¢å¼ä¸æ­£ | `AI_RESPONSE_INVALID` | è§£æå¤±æ•—ã‚’ä¼ãˆã€æ’®ã‚Šç›´ã—ã‚„åˆ¥è§’åº¦ã§ã®æ’®å½±ã‚’ææ¡ˆã™ã‚‹ã€‚ |



### 5. å®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

#### 5.1 ã‚µãƒ¼ãƒãƒ¼å´ï¼ˆActions / API Routesï¼‰ï¼šä¾‹å¤–ã‚¹ãƒ­ãƒ¼ã®ä½œæ³•
ã‚¨ãƒ©ãƒ¼æ™‚ã¯å¿…ãš `AppError` ã‚’ throw ã™ã‚‹ã€‚`catch` ãƒ–ãƒ­ãƒƒã‚¯å†…ã§ã¯æƒ…å ±ã®æå¤±ã‚’é˜²ããŸã‚ã€æ—¢ã« `AppError` ã§ã‚ã‚‹å ´åˆã¯ãã®ã¾ã¾å†ã‚¹ãƒ­ãƒ¼ã—ã€æœªçŸ¥ã®ã‚¨ãƒ©ãƒ¼ã®ã¿æ±ç”¨ã‚³ãƒ¼ãƒ‰ã¸å¤‰æ›ã™ã‚‹ã€‚

```typescript
try {
  // ãƒ­ã‚¸ãƒƒã‚¯
} catch (error: any) {
  if (error.code) throw error; // æ—¢å­˜ã®AppErrorï¼ˆãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ç­‰ï¼‰ã¯ãã®ã¾ã¾é€šã™
  console.error("Internal Error:", error);
  throw new AppError("DATA_SAVE_FAILED", 500); // æœªå®šç¾©ã®ã‚¨ãƒ©ãƒ¼ã‚’ç¿»è¨³
}

## 6. Components Utilization / æ—¢å­˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ã®å¼·åˆ¶åˆ©ç”¨

### 6.1 Component Folder Policy
* **Rule (JP)**: UIå®Ÿè£…æ™‚ã€`components/` ãƒ•ã‚©ãƒ«ãƒ€å†…ã®æ—¢å­˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å„ªå…ˆçš„ã«å†åˆ©ç”¨ã™ã‚‹ã“ã¨ã€‚ç‹¬è‡ªã® `alert` ã‚„ `div` ã«ã‚ˆã‚‹å³å¸­ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä½œæˆã¯ç¦æ­¢ã€‚
* **Core Components**: `MessageBox.tsx`, `ErrorHandler.tsx`, `ActionButton.tsx`.

### 6.2 Import Path Policy
* **Path Alias**: å¿…ãš `@/` ã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ã€‚ç›¸å¯¾ãƒ‘ã‚¹ï¼ˆ`../../` ç­‰ï¼‰ã¯ä½¿ç”¨ç¦æ­¢ã€‚

## 7. Currency & Reward System (Gold System) / é€šè²¨ãƒ»å ±é…¬ã‚·ã‚¹ãƒ†ãƒ ä»•æ§˜

### 7.1 Currency Definition
* **Symbol**: ğŸª™
* **Storage**: `gold` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆå…¨ã‚¢ãƒ—ãƒªå…±é€šæŒ‡æ¨™ï¼‰ã€‚
* **Rule (JP)**: æ•°å€¤è¡¨ç¤ºã«ã¯å¿…ãš `Intl.NumberFormat('ja-JP')` ã‚’ä½¿ç”¨ã—ã€ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã«ã™ã‚‹ã“ã¨ã€‚

### 7.2 GoldStatus Component
* **Requirement**: ã‚´ãƒ¼ãƒ«ãƒ‰è¡¨ç¤ºã«ã¯å¿…ãš `@/components/GoldStatus.tsx` ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã€‚

## 8. Standard ActionButton / æ¨™æº–ãƒœã‚¿ãƒ³ä»•æ§˜

### 8.1 Unified Implementation
* **Rule (JP)**: éåŒæœŸå‡¦ç†ã‚’ä¼´ã†æ“ä½œã«ã¯ã€`useTransition` ã¨ä½µç”¨ã—ãŸ `@/components/ActionButton` ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã€‚
* **Loading States**: ãƒœã‚¿ãƒ³ãŒ `disabled` ã®é–“ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã€Œè§£æä¸­...ã€ãªã©ã®æ˜ç¢ºãªè¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ä¸ãˆã‚‹ã“ã¨ã€‚

# ç¬¬9ç« ãƒ»ç¬¬10ç« ï¼šç”»é¢æ¨™æº–ä»•æ§˜ï¼ˆ2026-02-22 æ”¹è¨‚ï¼‰

## ç¬¬9ç« ï¼šç”»é¢ç¨®åˆ¥ã¨æ§‹æˆã®å®šç¾©

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹æˆã™ã‚‹å„ç”»é¢ã‚’ä»¥ä¸‹ã®é€šã‚Šåˆ†é¡ã—ã€ä¸€è²«ã—ãŸUI/UXã‚’æä¾›ã™ã‚‹ã€‚

### 9.1 GlobalPortal ç”»é¢ï¼ˆãƒãƒ¼ã‚¿ãƒ«ï¼‰
ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®å…¥ã‚Šå£ã€‚ã‚«ãƒ¼ãƒ‰å‹ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ¡ç”¨ã—ã€è¦–è¦šçš„ãªã‚ã‹ã‚Šã‚„ã™ã•ã‚’æä¾›ã™ã‚‹ã€‚
* **å¯¾è±¡**: `@/app/page.tsx`
* **æ§‹æˆ**: `GUIDE_CONTENTS` ã«åŸºã¥ãã‚«ãƒ¼ãƒ‰å‹ UIã€‚å„ã‚«ãƒ¼ãƒ‰ã«ã¯ã€Œã‚³ãƒ³ã‚»ãƒ—ãƒˆã‚¤ãƒ©ã‚¹ãƒˆã€ã€Œã‚¿ã‚¤ãƒˆãƒ«ã€ã€Œã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼ï¼ˆtaglineï¼‰ã€ã‚’è¡¨ç¤ºã€‚
* **èƒŒæ™¯**: ã‚·ã‚¹ãƒ†ãƒ å…±é€šã®å£ç´™ï¼ˆ`toppage_wheel_labo.png`ï¼‰ã‚’ `opacity-10` ã§é…ç½®ã—ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å¯èª­æ€§ã‚’æœ€å„ªå…ˆã™ã‚‹ã€‚
* **ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³**: ãƒ«ãƒ¼ãƒˆç”»é¢ã®ãŸã‚æˆ»ã‚‹ãƒœã‚¿ãƒ³ã¯ä¸è¦ã€‚

### 9.2 AppPortal ç”»é¢ï¼ˆå„ã‚¢ãƒ—ãƒªã®æ‹ ç‚¹ï¼‰
å„ã‚¢ãƒ—ãƒªæ©Ÿèƒ½ï¼ˆã‚«ãƒ­ãƒªãƒ¼ã€Shogiç­‰ï¼‰ã®æ‹ ç‚¹ã€‚
* **å¯¾è±¡**: `@/app/(å„ã‚¢ãƒ—ãƒª)/page.tsx`
* **æ¨™æº–æ§‹æˆ**: å½“è©²ã‚¢ãƒ—ãƒªã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚µãƒãƒªãƒ¼ã‚’æœ€ä¸Šéƒ¨ã«é…ç½®ã€‚
* **ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³**: ç”»é¢å·¦ä¸Šã« **ã€Œãƒãƒ¼ã‚¿ãƒ«ã¸æˆ»ã‚‹ã€**ï¼ˆGlobalPortal ã¸ã®ãƒªãƒ³ã‚¯ï¼‰ã‚’é…ç½®ã€‚
* **ãƒ˜ãƒ«ãƒ—æ©Ÿèƒ½**: æˆ»ã‚‹ãƒœã‚¿ãƒ³ã®ã™ãå³éš£ã«ã€Œï¼Ÿã€ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆãƒ˜ãƒ«ãƒ—ãƒœã‚¿ãƒ³ï¼‰ã‚’é…ç½®ã—ã€ç¬¬10ç« ã® WelcomeGuide ã‚’ã„ã¤ã§ã‚‚å‘¼ã³å‡ºã›ã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã€‚

### 9.3 List ç”»é¢
å±¥æ­´ã€ä¿å­˜ãƒ‡ãƒ¼ã‚¿ã€æ¤œç´¢çµæœãªã©ã‚’ç¾…åˆ—ã™ã‚‹ç”»é¢ã€‚
* **ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³**: ç”»é¢å·¦ä¸Šã« **ã€Œã‚¢ãƒ—ãƒªãƒãƒ¼ã‚¿ãƒ«ã¸æˆ»ã‚‹ã€**ï¼ˆAppPortal ã¸ã®ãƒªãƒ³ã‚¯ï¼‰ã‚’é…ç½®ã€‚
* **è¡Œæ“ä½œä»•æ§˜**:
    * **Grip (Left)**: ä¸¦ã³æ›¿ãˆç”¨ã‚¢ã‚¤ã‚³ãƒ³ `GripVertical` (Lucide) ã‚’é…ç½®ã€‚
    * **Content**: ä¸­å¤®ã«ä¸»è¦ãƒ‡ãƒ¼ã‚¿ã‚’é…ç½®ã€‚
    * **Delete (Right)**: èµ¤è‰²ã® `Trash2` ã‚¢ã‚¤ã‚³ãƒ³ (Lucide) ã‚’é…ç½®ã€‚
    * **Interaction**: å‰Šé™¤æ™‚ã¯å³æ™‚å®Ÿè¡Œã›ãšã€å¿…ãš `FFMessageBox` ç­‰ã§ç¢ºèªã‚’æŒŸã‚€ã“ã¨ã€‚

### 9.4 Action ç”»é¢
AIè§£æã€ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã€æ’®å½±ãªã©ã€èƒ½å‹•çš„ãªæ“ä½œã‚’ä¼´ã†ç”»é¢ã€‚
* **AI Integration**: éŸ³å£°ãƒ»ç”»åƒãƒ»ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã«ã¯ `AIAssistantDrawer` ã‚’ä½¿ç”¨ã€‚
* **ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³**: ç”»é¢å·¦ä¸Šã« **ã€Œã‚¢ãƒ—ãƒªãƒãƒ¼ã‚¿ãƒ«ã¸æˆ»ã‚‹ã€**ï¼ˆAppPortal ã¸ã®ãƒªãƒ³ã‚¯ï¼‰ã‚’é…ç½®ã€‚

### 9.5 Play ç”»é¢
ãƒ­ã‚±ãƒƒãƒˆã‚²ãƒ¼ãƒ ã‚„å°†æ£‹ãªã©ã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªæ“ä½œãŒä¸»ã®ç”»é¢ã€‚
* **Immersive Design**: ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æœ€å°åŒ–ã€‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯å¸¸ã«ä¸‹éƒ¨ä¸­å¤®ã«é…ç½®ã€‚
* **ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³**: ç”»é¢å·¦ä¸Šã« **ã€Œã‚¢ãƒ—ãƒªãƒãƒ¼ã‚¿ãƒ«ã¸æˆ»ã‚‹ã€**ï¼ˆAppPortal ã¸ã®ãƒªãƒ³ã‚¯ï¼‰ã‚’é…ç½®ã€‚
* **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º**: ç”»é¢**å³ä¸Š**ã«ç¾åœ¨ä¿æŒã—ã¦ã„ã‚‹ã€Œã‚´ãƒ¼ãƒ«ãƒ‰ï¼ˆé€šè²¨ï¼‰ã€ã‚’å¸¸æ™‚è¡¨ç¤ºã™ã‚‹ã“ã¨ã€‚

### 9.6 Result ç”»é¢
AIã®æ¨å®šçµæœè©³ç´°ã‚„ã€ã‚²ãƒ¼ãƒ ã®ã‚¹ã‚³ã‚¢ãªã©ã‚’è¡¨ç¤ºã™ã‚‹å°‚ç”¨ç”»é¢ã€‚
* **ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³**: ç”»é¢å·¦ä¸Šã« **ã€Œã‚¢ãƒ—ãƒªãƒãƒ¼ã‚¿ãƒ«ã¸æˆ»ã‚‹ã€**ï¼ˆAppPortal ã¸ã®ãƒªãƒ³ã‚¯ï¼‰ã‚’é…ç½®ã€‚

## ç¬¬10ç« ï¼šç”»é¢å…±é€šãƒ‡ã‚¶ã‚¤ãƒ³ãƒ»ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³
ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç¾åœ¨åœ°ã‚’è¦‹å¤±ã‚ãšã€ä¸€è²«ã—ãŸæ“ä½œæ„Ÿã‚’å¾—ã‚‹ãŸã‚ã«ä»¥ä¸‹ã®é…ç½®ãƒ«ãƒ¼ãƒ«ã‚’å³å®ˆã™ã‚‹ã€‚

### 10.1 æˆ»ã‚‹ãƒœã‚¿ãƒ³ã®é…ç½®
ç”»é¢ã®å·¦ä¸Šã«ã€ä¸Šä½éšå±¤ã¾ãŸã¯é·ç§»å…ƒã¸æˆ»ã‚‹ãŸã‚ã®ãƒœã‚¿ãƒ³ã‚’é…ç½®ã™ã‚‹ã€‚
* **AppPortalç”»é¢**: ç”»é¢å·¦ä¸Šã« **ã€Œãƒãƒ¼ã‚¿ãƒ«ã¸æˆ»ã‚‹ã€**ï¼ˆGlobalPortalã¸ã®ãƒªãƒ³ã‚¯ï¼‰ã‚’é…ç½®ã€‚
* **List / Action / Result / Playç”»é¢**: ç”»é¢å·¦ä¸Šã« **ã€Œã‚¢ãƒ—ãƒªãƒãƒ¼ã‚¿ãƒ«ã¸æˆ»ã‚‹ã€**ï¼ˆå½“è©²AppPortalã¸ã®ãƒªãƒ³ã‚¯ï¼‰ã‚’é…ç½®ã€‚
* **å‘½åè¦å‰‡**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ··ä¹±ã‚’é˜²ããŸã‚ã€ã€Œãƒãƒ¼ã‚¿ãƒ«ã€ã¾ãŸã¯ã€Œã‚¢ãƒ—ãƒªãƒãƒ¼ã‚¿ãƒ«ã€ã¨ã„ã†å‘¼ç§°ã‚’æ­£ç¢ºã«ä½¿ã„åˆ†ã‘ã‚‹ã“ã¨ã€‚

### 10.2 ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«è¡¨ç¤ºã¨æ—¢èª­ç®¡ç†
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åˆè¨ªæ™‚ã®é›¢è„±ã‚’é˜²ãã€ã‚¹ãƒ ãƒ¼ã‚ºãªä½“é¨“ã‚’æä¾›ã™ã‚‹ãŸã‚ã®ã‚¬ã‚¤ãƒ‰è¡¨ç¤ºãŠã‚ˆã³ç®¡ç†ã‚’è¡Œã†ã€‚
* **WelcomeGuideã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**: 
    * **å½¢çŠ¶**: ç”»é¢ä¸­å¤®ã«è¡¨ç¤ºã•ã‚Œã‚‹æ­£æ–¹å½¢ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ï¼ˆaspect-squareï¼‰ã€‚
    * **è¦–è¦šåŠ¹æœ**: èƒŒæ™¯ã¯ backdrop-blur-sm ã§é€éã•ã›ã€ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’é«˜ã‚ã‚‹ã€‚
    * **ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«**: ã‚¬ã‚¤ãƒ‰ã®æœ€ä¸Šéƒ¨ã«ã€å½“è©²ã‚¢ãƒ—ãƒªã®ã‚³ãƒ³ã‚»ãƒ—ãƒˆã‚’è¡¨ã™ã‚¤ãƒ©ã‚¹ãƒˆï¼ˆimageï¼‰ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ã€‚ç”»åƒä¸‹éƒ¨ã«ã¯èƒŒæ™¯è‰²ã¸ã®ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é‡ã­ã€ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã¸æ»‘ã‚‰ã‹ã«ç¹‹ã’ã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³ã¨ã™ã‚‹ã€‚
    * **æ§‹æˆ**: ã€Œæ¦‚è¦ã€ã€Œä½¿ã„ã‹ãŸã€ã€ŒæŠ€è¡“æ§‹æˆã€ã®3ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¨ã€å›ºå®šã®å®Œäº†ãƒœã‚¿ãƒ³ã€‚
* **æ—¢èª­ç®¡ç†ãƒ­ã‚¸ãƒƒã‚¯ (`useSessionFirstTime`)**:
    * `sessionStorage` ã‚’åˆ©ç”¨ã—ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¿ãƒ–ã‚’é–‰ã˜ã‚‹ã¾ã§æ—¢èª­çŠ¶æ…‹ã‚’ç¶­æŒã™ã‚‹ã€‚

### 10.3 ãƒ˜ãƒ«ãƒ—ï¼ˆå†è¡¨ç¤ºï¼‰ãƒœã‚¿ãƒ³ã®é…ç½®
ä¸€åº¦é–‰ã˜ãŸã‚¬ã‚¤ãƒ‰ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã„ã¤ã§ã‚‚å‘¼ã³å‡ºã›ã‚‹ã‚ˆã†ã€ä»¥ä¸‹ã®ãƒ«ãƒ¼ãƒ«ã§ãƒœã‚¿ãƒ³ã‚’é…ç½®ã™ã‚‹ã€‚
* **é…ç½®å ´æ‰€**: ç”»é¢å·¦ä¸Šã€ã€Œæˆ»ã‚‹ãƒœã‚¿ãƒ³ã€ã®**ã™ãå³éš£**ã«é…ç½®ã€‚
* **ãƒ‡ã‚¶ã‚¤ãƒ³**: `HelpCircle` ã‚¢ã‚¤ã‚³ãƒ³ç­‰ã‚’ä½¿ç”¨ã—ã€ç›´æ„Ÿçš„ã«ãƒ˜ãƒ«ãƒ—ã¨ã‚ã‹ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚
* **å®Ÿè£…**: `showAgain` é–¢æ•°ã‚’ãƒˆãƒªã‚¬ãƒ¼ã—ã€`WelcomeGuide` ã‚’å¼·åˆ¶çš„ã«å†è¡¨ç¤ºã•ã›ã‚‹ã€‚

### 10.4 Playç”»é¢ç‰¹æœ‰ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º
* **é€šè²¨è¡¨ç¤º**: Playç”»é¢ã«é™ã‚Šã€ç”»é¢**å³ä¸Š**ã«ç¾åœ¨ä¿æŒã—ã¦ã„ã‚‹ã€Œã‚´ãƒ¼ãƒ«ãƒ‰ï¼ˆé€šè²¨ï¼‰ã€ã‚’å¸¸æ™‚è¡¨ç¤ºã™ã‚‹ã“ã¨ã€‚

### 10.5 ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯è¡¨ç¤º
* **ã‚¨ãƒ©ãƒ¼å¯¾å¿œ**: `ErrorHandler` ãŠã‚ˆã³ `MessageBox` ã‚’ä½¿ç”¨ã—ã€è§£æ±ºç­–ã‚’æç¤ºã™ã‚‹ã€‚
* **å‰Šé™¤ç¢ºèª**: å‰Šé™¤æ™‚ã¯å³æ™‚å®Ÿè¡Œã›ãšã€å¿…ãš `FFMessageBox` ç­‰ã§ç¢ºèªã‚’æŒŸã‚€ã“ã¨ã€‚

### 10.6 è¦–è¦šçš„æ¼”å‡ºã¨å¯èª­æ€§æ¨™æº–ï¼ˆæ–°è¦è¿½åŠ ï¼‰
* **èƒŒæ™¯ç”»åƒã®é€æ˜åº¦**: ã‚¢ãƒ—ãƒªãƒãƒ¼ã‚¿ãƒ«ãŠã‚ˆã³ãƒ—ãƒ¬ã‚¤ç”»é¢ã®èƒŒæ™¯ç”»åƒï¼ˆImageã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰ã¯ã€UIã®æ–‡å­—ã‚’èª­ã¿ã‚„ã™ãã™ã‚‹ãŸã‚ä¸€å¾‹ **`opacity-10` (0.1)** ã‚’åŸºæº–ã¨ã™ã‚‹ã“ã¨ã€‚
* **ã‚«ãƒ¼ãƒ‰æ¼”å‡º**: ãƒãƒ¼ã‚¿ãƒ«ã®ã‚«ãƒ¼ãƒ‰ç­‰ã¯ã€ãƒ›ãƒãƒ¼æ™‚ã« `scale-105` ã‚„ `shadow-xl` ãªã©ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä»˜ä¸ã—ã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªæ„Ÿè§¦ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ä¸ãˆã‚‹ã€‚
* **ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤**: èƒŒæ™¯ç”»åƒã®ä¸Šã«ã¯å¿…è¦ã«å¿œã˜ã¦æš—è‰²ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚’é‡ã­ã€UIè¦ç´ ãŒèƒŒæ™¯ã¨æ··ã–ã‚‰ãªã„ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã€‚


### 11. React Hooks & State Management / Reactãƒ•ãƒƒã‚¯ãƒ»çŠ¶æ…‹ç®¡ç†æ¨™æº–
## 11.1 Rules of Hooks (ãƒ•ãƒƒã‚¯ã®çµ¶å¯¾åŸå‰‡)
Rule (JP): ã€Œãƒ•ãƒƒã‚¯ã®å‘¼ã³å‡ºã—é †åºã€ã‚’å›ºå®šã™ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®æ§‹é€ ã‚’å³å®ˆã™ã‚‹ã“ã¨ã€‚
Top Level Hooks: useState, useEffect, useMemo ç­‰ã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å†’é ­ã«è¨˜è¿°ã™ã‚‹ã€‚
Early Returns: loading ã‚„ error ã«ã‚ˆã‚‹æ¡ä»¶åˆ†å²ãƒªã‚¿ãƒ¼ãƒ³ã¯ã€å¿…ãšå…¨ã¦ã®ãƒ•ãƒƒã‚¯å‘¼ã³å‡ºã—ã‚ˆã‚Šã‚‚å¾Œã«è¨˜è¿°ã™ã‚‹ã“ã¨ã€‚
Main Render: æ­£å¸¸ç³»ã® JSX ã‚’æœ€å¾Œã«è¨˜è¿°ã™ã‚‹ã€‚
Rule (EN): Strictly follow the Rules of Hooks to ensure consistent calling order.
Place all hooks at the top of the component.
Execute conditional early returns (e.g., loading, error) only after all hook declarations.

## 11.2 State Management Policy (çŠ¶æ…‹ç®¡ç†æ–¹é‡)
Rule (JP): ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã® useState ã¯æœ€å°é™ã«ç•™ã‚ã‚‹ã€‚
Calculated Values: ä»–ã® State ã‹ã‚‰è¨ˆç®—å¯èƒ½ãªå€¤ï¼ˆä¾‹ï¼šæ°åã‹ã‚‰ç”Ÿæˆã™ã‚‹ãƒ•ãƒ«ãƒãƒ¼ãƒ ï¼‰ã¯ State ã«å…¥ã‚Œãšã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ™‚ã«è¨ˆç®—ã™ã‚‹ã“ã¨ã€‚
Prop Mirroring: è¦ªã‹ã‚‰å—ã‘å–ã£ãŸ Props ã‚’ãã®ã¾ã¾ useState ã®åˆæœŸå€¤ã«è¨­å®šã—ãªã„ï¼ˆåŒæœŸã‚ºãƒ¬é˜²æ­¢ï¼‰ã€‚
Rule (EN): Minimize useState usage. Avoid storing values that can be derived from existing state or props.

ãƒ«ãƒ¼ãƒ«: ãƒšãƒ¼ã‚¸é·ç§»ï¼ˆrouter.pushï¼‰ã‚„é‡è¦ãªçŠ¶æ…‹æ›´æ–°ã‚’ä¼´ã†ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã§ã¯ã€å¿…ãš isPending ã¾ãŸã¯ isNavigating ãƒ•ãƒ©ã‚°ã‚’ç”¨ã„ã¦ã€é‡è¤‡å®Ÿè¡Œã‚’ã‚¬ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã€‚

## 11.3 Guest Mode & Persistence Strategy (ã‚²ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ã¨ä¿å­˜ã®åˆ‡ã‚Šåˆ†ã‘)
Concept: ã€Œã¾ãšè©¦ã™ï¼ˆGuestï¼‰ã€ã‹ã‚‰ã€Œä¿å­˜ã™ã‚‹ï¼ˆUserï¼‰ã€ã¸ã®æ®µéšçš„ç§»è¡Œã‚’æ”¯æ´ã™ã‚‹ã€‚

Guest Mode:
ãƒ­ã‚°ã‚¤ãƒ³å‰ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã® localStorage ã¾ãŸã¯ Session ã«ä¸€æ™‚ä¿å­˜ã™ã‚‹ã€‚
å€‹äººæƒ…å ±ï¼ˆGmail, å›³æ›¸é¤¨IDç­‰ï¼‰ã‚’è¦æ±‚ã—ãªã„ã€‚
Login Mode:
ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ï¼ˆåå‰ãƒ»ã‚¢ã‚¤ã‚³ãƒ³é¸æŠï¼‰å¾Œã€localStorage ã®ãƒ‡ãƒ¼ã‚¿ã‚’ Prisma ã‚’é€šã˜ã¦ DB ã¸ä¸€æ‹¬ç§»è¡Œã™ã‚‹ã€‚
å›³æ›¸é¤¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç­‰ã®æ©Ÿå¯†æƒ…å ±ã¯ã€å¿…ãšå¯é€†çš„ãªæš—å·åŒ–ï¼ˆAES-256ç­‰ï¼‰ã‚’æ–½ã—ã€ç’°å¢ƒå¤‰æ•°ã«ç§˜åŒ¿ã•ã‚ŒãŸéµã‚’ç”¨ã„ã¦ç®¡ç†ã™ã‚‹ã“ã¨ã€‚

### 12. Logic Separation (ãƒ­ã‚¸ãƒƒã‚¯ã®åˆ†é›¢)
## 12.1 Client vs Server Component
Rule (JP): å¯èƒ½ãªé™ã‚Šã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’åŸºæœ¬ã¨ã—ã€"use client" ã‚’ä»˜ä¸ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€Œãƒœã‚¿ãƒ³æ“ä½œã€ã‚„ã€ŒStateã€ãŒå¿…è¦ãªæœ€å°å˜ä½ã«é™å®šã™ã‚‹ã“ã¨ã€‚
Rule (EN): Use Server Components as the default. Limit "use client" to the smallest possible unit that requires interactivity or state.

## 12.2 Action Separation
Rule (JP): APIé€šä¿¡ï¼ˆGoogle Books APIç­‰ï¼‰ã€ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã€è¤‡é›‘ãªãƒ‡ãƒ¼ã‚¿åŠ å·¥ãƒ­ã‚¸ãƒƒã‚¯ã¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã«ç›´æ¥æ›¸ã‹ãšã€å¿…ãš actions.ts ã¾ãŸã¯ utils/ ãƒ•ã‚©ãƒ«ãƒ€ã¸åˆ†é›¢ã™ã‚‹ã“ã¨ã€‚
Rule (EN): Separate business logic (API calls, data processing) from UI components into actions.ts or utils/.


---
ä½œæˆæ—¥: 2024-xx-xx
ãƒãƒ¼ã‚¸ãƒ§ãƒ³: v1.4.0 (Full Standard Integrated)