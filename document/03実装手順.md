# 実装手順書

## 1. 概要

このドキュメントでは、「[02設計仕様.md](02設計仕様.md)」に基づき、郵便番号検索アプリケーションを実装するための手順を段階的に説明します。

作業は以下の3つのステップで進めます。

1.  **HTMLファイルの作成:** ウェブページの骨格（構造）を作ります。
2.  **CSSファイルの作成:** ページの見た目を整えます。
3.  **JavaScriptファイルの作成:** 郵便番号検索の機能を追加します。

---

## 2. 実装ステップ

### ステップ1: HTMLファイル (`index.html`) の作成

まず、ウェブページの基本的な構造を定義します。カード型レイアウトを採用し、要素を中央に配置します。

1.  `実装/` フォルダに `index.html` という名前でファイルを作成します。
2.  以下の内容を `index.html` に記述します。

```html
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>郵便番号住所検索</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="card">
        <h1>郵便番号住所検索</h1>

        <div class="input-group">
            <input type="text" id="zipcode" placeholder="郵便番号 (例: 1000001)" maxlength="7" pattern="[0-9]*" inputmode="numeric">
        </div>

        <button id="search-btn">検索</button>

        <div id="result-area">
            <p>ここに住所が出ます</p>
        </div>

        <div id="history-area">
            <h2>検索履歴</h2>
            <ul id="history-list">
                <!-- 履歴がここに表示されます -->
            </ul>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
```
*   **ポイント:**
    *   `<div class="card">`で全体のコンテナを作り、中央に配置します。
    *   `<label>`を廃止し、`placeholder`で入力内容を案内します。
    *   タイトルとボタンの文言を設計に合わせて変更しました。

---

### ステップ2: CSSファイル (`style.css`) の作成

次に、`sample.png`の画像で示されたデザインを再現するためのCSSを作成します。

1.  `実装/` フォルダに `style.css` という名前でファイルを作成します。
2.  以下の内容を `style.css` に記述します。

```css
body {
    font-family: 'Hiragino Kaku Gothic ProN', 'Meiryo', sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    background-color: #f0f2f5;
}

.card {
    background-color: #ffffff;
    padding: 40px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    width: 100%;
    max-width: 400px;
    text-align: center;
}

h1 {
    font-size: 1.8em;
    color: #333;
    margin-bottom: 30px;
}

.input-group {
    margin-bottom: 20px;
}

#zipcode {
    width: 100%;
    padding: 12px;
    border: 1px solid #ccc;
    border-radius: 8px;
    box-sizing: border-box; /* paddingを含めてwidthを100%に保つ */
    font-size: 1em;
    text-align: center;
}

#search-btn {
    width: 100%;
    padding: 12px;
    cursor: pointer;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 1.1em;
    font-weight: bold;
    transition: background-color 0.3s;
}

#search-btn:hover {
    background-color: #0056b3;
}

#result-area {
    margin-top: 20px;
    padding: 15px;
    border: 1px solid #e0e0e0;
    background-color: #f9f9f9;
    min-height: 50px;
    border-radius: 8px;
    word-wrap: break-word;
}

#history-area {
    margin-top: 30px;
    text-align: left;
}

h2 {
    font-size: 1.2em;
    color: #555;
    border-bottom: 1px solid #eee;
    padding-bottom: 10px;
    margin-bottom: 10px;
}

#history-list {
    list-style-type: none;
    padding: 0;
    max-height: 200px;
    overflow-y: auto;
}

#history-list li {
    background-color: #fff;
    padding: 10px;
    border-bottom: 1px solid #f0f0f0;
}

#history-list li:last-child {
    border-bottom: none;
}
```

---

### ステップ3: JavaScriptファイル (`script.js`) の作成

JavaScriptのロジックは前回から大きな変更はありませんが、改めて最終的なコードを記載します。

1.  `実装/` フォルダに `script.js` という名前でファイルを作成します（または既存のファイルを上書きします）。
2.  以下の内容を `script.js` に記述します。

```javascript
document.addEventListener('DOMContentLoaded', () => {
    // HTML要素への参照を取得
    const searchBtn = document.getElementById('search-btn');
    const zipcodeEl = document.getElementById('zipcode');
    const resultArea = document.getElementById('result-area');
    const historyList = document.getElementById('history-list');

    // 定数
    const API_URL = 'https://zipcloud.ibsnet.co.jp/api/search';
    const HISTORY_KEY = 'zipcodeHistory';
    const MAX_HISTORY_COUNT = 10;

    // --- 履歴関連の関数 ---

    const renderHistory = (history) => {
        historyList.innerHTML = '';
        history.forEach(item => {
            const li = document.createElement('li');
            li.textContent = `〒${item.zipcode}: ${item.address}`;
            historyList.appendChild(li);
        });
    };

    const loadHistory = () => {
        const history = JSON.parse(sessionStorage.getItem(HISTORY_KEY)) || [];
        renderHistory(history);
    };

    const addHistory = (zipcode, address) => {
        let history = JSON.parse(sessionStorage.getItem(HISTORY_KEY)) || [];
        history.unshift({ zipcode, address });
        if (history.length > MAX_HISTORY_COUNT) {
            history.pop();
        }
        sessionStorage.setItem(HISTORY_KEY, JSON.stringify(history));
        renderHistory(history);
    };

    // --- メインの検索処理 ---
    const handleSearch = async () => {
        const zipcode = zipcodeEl.value;

        if (!zipcode) {
            resultArea.innerHTML = '<p style="color: red;">郵便番号を入力してください。</p>';
            return;
        }

        const requestUrl = `${API_URL}?zipcode=${zipcode}`;
        resultArea.innerHTML = '<p>検索中...</p>';

        try {
            const response = await fetch(requestUrl);
            const data = await response.json();

            if (data.status === 200 && data.results) {
                const address = data.results[0];
                const fullAddress = `${address.address1} ${address.address2} ${address.address3}`;
                resultArea.innerHTML = `<p>${fullAddress}</p>`;
                addHistory(zipcode, fullAddress);
            } else {
                resultArea.innerHTML = `<p style="color: red;">住所が見つかりませんでした。（${data.message || ''}）</p>`;
            }
        } catch (error) {
            console.error('APIリクエスト中にエラーが発生しました:', error);
            resultArea.innerHTML = '<p style="color: red;">通信エラーが発生しました。</p>';
        } finally {
            zipcodeEl.value = '';
            zipcodeEl.focus();
        }
    };

    // --- イベントリスナーの設定 ---
    searchBtn.addEventListener('click', handleSearch);
    
    zipcodeEl.addEventListener('keydown', (event) => {
        if (event.key === 'Enter') {
            handleSearch();
        }
    });

    // --- 初期化処理 ---
    loadHistory();
    zipcodeEl.focus();
});
```

---

以上で、仕様に基づいた実装は完了です。`index.html`をウェブブラウザで開くと、`sample.png`のデザインに近い郵便番号検索アプリケーションが動作します。