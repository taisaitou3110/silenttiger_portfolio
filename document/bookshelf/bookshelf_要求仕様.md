図書館アプリ

アプリ仕様書：Book Asset Manager (仮)
1. コンセプト
「読書を資産に変える」をテーマに、図書館・Amazon・中古買取の履歴を統合管理し、知識の定着（単語帳）と資産価値の最適化を支援する。

2. ユーザーモードの定義
「まずは使ってみる」を最優先にし、段階的な情報登録を促します。
モード	認証	保存先	利用可能な機能
ゲストモード	不要（即開始）	ブラウザ (LocalStorage)	ISBNスキャン、書籍検索、再読スコア設定(一時)
ユーザー登録	簡易ログイン選択	DB (Prisma / Azure)	データの永続保存、複数端末同期、Wikipedia風単語帳連携
フル連携	Gmail/図書館認証	DB (暗号化保存)	図書館履歴自動取得、Amazon/Valuebooks自動取り込み
3. 機能要件
① ゲストモード（初期体験）
* クイック・スタート: アプリを開いて「ゲストで開始」を押すだけでメイン画面へ。
* ISBNスキャン: スマホカメラでバーコードを読み取り、Google Books APIから書籍情報を取得。
* カーリル蔵書検索: スキャンした本が「呉市図書館」「東広島市図書館」にあるか、現在の貸出状況をリアルタイム表示。
* 再読可能性セット: 手動で「再読スコア(1~5)」をポチポチ入力。
② ユーザー登録・データ移行
* 移行トリガー: 「データを保存する」ボタンを押した際に、簡易的なユーザー登録（名前とアイコン選択のみ）を要求。
* 自動インポート: ゲストモード中にブラウザに保存していた一時データを、登録完了と同時にDBへ移行。
③ 高度な連携（登録後オプション）
* 図書館マイページ連携:
    * 呉市・東広島市のID/Passを登録。
    * バックグラウンド（Playwright等）で「マイ本棚」から履歴を取得。
* Gmail解析連携:
    * Gmail APIを使用して、Amazonの購入メールやValuebooksの買取メールからデータを自動抽出。
    * ハードル対策: 「Amazonの履歴だけ連携する」「図書館だけ連携する」と、ユーザーが項目ごとに許可を選べるようにする。

4. データ活用・画面構成
A. 読書マネジメント画面
* 「売却・保管・借用」のステータス表示:
    * 図書館で借りた本は返却期限を表示。
    * 手元の本は「Valuebooksでの現在の推定買取価格」を（可能であれば）表示。
B. Wikipedia風単語帳（以前のアイデアとの融合）
* 読書録からの用語抽出:
    * 本の詳細画面に「この本に関連する単語を登録」ボタンを設置。
    * 登録された単語は「どの本に書いてあったか」のバックリンクを持つ。

5. 技術スタック
* フロントエンド: Next.js (App Router)
* データベース: PostgreSQL (Azure) + Prisma
* インフラ: Vercel (Frontend) + Azure (DB / Scraping Worker)
* 主なAPI:
    * Google Books API (書籍情報)
    * カーリルAPI (図書館蔵書)
    * Gmail API (購入・売却履歴)

6. 開発マイルストーン（ロードマップ）
1. Phase 1 (MVP):
    * ゲストモードでISBNスキャン & ローカル保存機能の実装。
    * 呉市・東広島市図書館の在庫確認機能（カーリルAPI）。
2. Phase 2 (保存機能):
    * 簡易ログインの実装とDB保存対応。
    * Wikipedia風単語帳との基本連携。
3. Phase 3 (自動化):
    * 図書館スクレイピング、Gmail API連携の実装。
